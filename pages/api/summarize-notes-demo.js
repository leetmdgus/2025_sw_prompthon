export default async function handler(req, res) {
  console.log('Demo API í˜¸ì¶œë¨:', req.method, req.url)
  
  if (req.method !== 'POST') {
    return res.status(405).json({ message: 'Method not allowed' })
  }

  try {
    const { notes, clientName, sessionNumber, date } = req.body
    console.log('ìš”ì²­ ë°ì´í„°:', { clientName, sessionNumber, date, notesLength: notes?.length })

    if (!notes) {
      return res.status(400).json({ message: 'Notes are required' })
    }

    // ë°ëª¨ìš© ë”ë¯¸ ìš”ì•½ ìƒì„± (OpenAI API í˜¸ì¶œ ì—†ì´)
    const demoSummary = `ðŸ” ${clientName} ì–´ë¥´ì‹  ${sessionNumber}íšŒì°¨ ìƒë‹´ ìš”ì•½ (ë°ëª¨)

ðŸ“… ìƒë‹´ ì •ë³´
â€¢ ìƒë‹´ì¼: ${date}
â€¢ íšŒì°¨: ${sessionNumber}íšŒì°¨
â€¢ í´ë¼ì´ì–¸íŠ¸: ${clientName} ì–´ë¥´ì‹ 

ðŸ“ ìƒë‹´ ë‚´ìš© ë¶„ì„
â€¢ ì£¼ìš” ì£¼ì œ: ê°€ì¡± ê´€ê³„, ì™¸ë¡œì›€ ê´€ë¦¬, ì‚¬íšŒì  êµë¥˜
â€¢ ê°ì • ìƒíƒœ: ì™¸ë¡œì›€ ì™„í™”, ê°€ì¡±ê³¼ì˜ ì†Œí†µ ê°œì„ 
â€¢ ì ìš©ëœ ì „ëžµ: í˜¸í¡ ìš´ë™, ì‚°ì±… í™œë™, ê°€ì¡± ì‚¬ì§„ì„ í†µí•œ ì¶”ì–µ ëŒ€í™”

ðŸ’¡ í•µì‹¬ í†µì°°
â€¢ ê°€ì¡±ê³¼ì˜ ì—°ê²°ì´ ì •ì„œì  ì•ˆì •ì— í•µì‹¬ ì—­í• 
â€¢ ì´ì›ƒê³¼ì˜ ì†Œí†µì´ ì™¸ë¡œì›€ ì™„í™”ì— íš¨ê³¼ì 
â€¢ ì²´ê³„ì ì¸ ëŒ€ì²˜ ì „ëžµ ì ìš©ì´ í•„ìš”

ðŸŽ¯ ê°œì„  ë°©í–¥
â€¢ ì§€ì†ì ì¸ ê°€ì¡± ì—°ê³„ ê°•í™”
â€¢ ì§€ì—­ì‚¬íšŒ í™œë™ ì°¸ì—¬ ì¦ì§„
â€¢ ì •ê¸°ì ì¸ ê°ì • ìƒíƒœ ëª¨ë‹ˆí„°ë§

ðŸ“Š ì„¸ì…˜ íš¨ê³¼ì„±
â€¢ ì™¸ë¡œì›€ ì ìˆ˜: ê°œì„  ì¶”ì„¸
â€¢ ì‚¬íšŒì  êµë¥˜: ì¦ê°€
â€¢ ì „ë°˜ì  ë§Œì¡±ë„: í–¥ìƒ

ðŸ”® ë‹¤ìŒ ìƒë‹´ ê³„íš
â€¢ ê°€ì¡±ê³¼ì˜ ì†Œí†µ ë¹ˆë„ ì¦ê°€
â€¢ ìƒˆë¡œìš´ ì·¨ë¯¸ í™œë™ ë„ìž…
â€¢ ì´ì›ƒê³¼ì˜ ê´€ê³„ ì‹¬í™”

ðŸ“‹ íŠ¹ì´ì‚¬í•­
â€¢ í˜¸í¡ ìš´ë™ì´ ì •ì„œ ì¡°ì ˆì— íš¨ê³¼ì 
â€¢ ê°€ì¡± ì‚¬ì§„ì´ ì¶”ì–µ íšŒìƒì— ë„ì›€
â€¢ ì‚°ì±…ì´ ê¸°ë¶„ ì „í™˜ì— ìœ ìš©

ðŸ’ª ê¶Œìž¥ì‚¬í•­
â€¢ ë§¤ì¼ ì•„ì¹¨ í˜¸í¡ ìš´ë™ ì‹¤ì²œ
â€¢ ì£¼ 3íšŒ ì´ìƒ ì‚°ì±… í™œë™
â€¢ ê°€ì¡±ê³¼ì˜ ì •ê¸°ì  ì—°ë½ ìœ ì§€
â€¢ ì´ì›ƒê³¼ì˜ ëŒ€í™” ì‹œê°„ í™•ëŒ€

ðŸŒŸ ê¸ì •ì  ë³€í™”
â€¢ ì™¸ë¡œì›€ ê°ì†Œ ê²½í—˜
â€¢ ê°€ì¡±ê³¼ì˜ ê´€ê³„ ê°œì„ 
â€¢ ì‚¬íšŒì  êµë¥˜ ì˜í–¥ ì¦ê°€
â€¢ ìžì•„ì¡´ì¤‘ê° í–¥ìƒ

âš ï¸ ì£¼ì˜ì‚¬í•­
â€¢ ê°ì • ë³€í™” ëª¨ë‹ˆí„°ë§ í•„ìš”
â€¢ ì§€ì†ì ì¸ ì •ì„œì  ì§€ì§€ ì œê³µ
â€¢ ê°€ì¡±ê³¼ì˜ ì†Œí†µ ë¹ˆë„ ìœ ì§€

ì´ ìš”ì•½ì€ ë°ëª¨ ë²„ì „ìœ¼ë¡œ, ì‹¤ì œ GPT APIë¥¼ í˜¸ì¶œí•˜ì§€ ì•Šê³  ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤.`

    return res.status(200).json({
      summary: demoSummary,
      lineCount: demoSummary.split('\n').filter(line => line.trim().length > 0).length,
      isDemo: true
    })
  } catch (error) {
    console.error('Demo API ì˜¤ë¥˜:', error)
    return res.status(500).json({ 
      message: 'Internal server error',
      error: error.message
    })
  }
}
